(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-182b879a","chunk-55dd3352"],{"1e36":function(t,e,r){"use strict";r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return n})),r.d(e,"c",(function(){return l})),r.d(e,"a",(function(){return i})),r.d(e,"f",(function(){return s})),r.d(e,"b",(function(){return u}));var a=r("b775");function o(t){return Object(a["a"])({url:"/iot/category/list",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/iot/category/shortlist",method:"get",params:t})}function l(t){return Object(a["a"])({url:"/iot/category/"+t,method:"get"})}function i(t){return Object(a["a"])({url:"/iot/category",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/iot/category",method:"put",data:t})}function u(t){return Object(a["a"])({url:"/iot/category/"+t,method:"delete"})}},"3acd":function(t,e,r){"use strict";r("7017")},7017:function(t,e,r){},"9b9c":function(t,e,r){"use strict";r.d(e,"e",(function(){return o})),r.d(e,"f",(function(){return n})),r.d(e,"d",(function(){return l})),r.d(e,"a",(function(){return i})),r.d(e,"g",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var a=r("b775");function o(t){return Object(a["a"])({url:"/iot/product/list",method:"get",params:t})}function n(){return Object(a["a"])({url:"/iot/product/shortList",method:"get"})}function l(t){return Object(a["a"])({url:"/iot/product/"+t,method:"get"})}function i(t){return Object(a["a"])({url:"/iot/product",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/iot/product",method:"put",data:t})}function u(t){return Object(a["a"])({url:"/iot/product/status/",method:"put",data:t})}function c(t){return Object(a["a"])({url:"/iot/product/"+t,method:"delete"})}},bbfb:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{"padding-left":"20px"}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:14}},[r("el-link",{staticStyle:{"padding-top":"5px"},attrs:{type:"danger",underline:!1}},[t._v("该功能，未完成")]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-bottom":"60px","margin-top":"20px"},attrs:{data:t.modelList,border:""}},[r("el-table-column",{attrs:{label:"名称",align:"center",prop:"modelName"}}),r("el-table-column",{attrs:{label:"标识符",align:"center",prop:"identifier"}}),r("el-table-column",{attrs:{label:"物模型类别",align:"center",prop:"type"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("dict-tag",{attrs:{options:t.dict.type.iot_things_type,value:e.row.type}})]}}])}),r("el-table-column",{attrs:{label:"数据类型",align:"center",prop:"datatype"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("dict-tag",{attrs:{options:t.dict.type.iot_data_type,value:e.row.datatype}})]}}])}),r("el-table-column",{attrs:{label:"部件",align:"center",prop:"part"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.part)+" 系统定义的部件 ")]}}])})],1),r("el-divider",[t._v("高级功能")]),r("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"自定义页面",prop:"page"}},[r("el-input",{attrs:{placeholder:"请输入自定义页面"},model:{value:t.form.page,callback:function(e){t.$set(t.form,"page",e)},expression:"form.page"}})],1)],1)],1),r("el-col",{attrs:{span:8,offset:2}},[r("div",{staticClass:"phone"},[r("div",{staticClass:"phone-container"})]),r("div",{staticStyle:{"text-align":"center","margin-top":"15px",width:"370px"}},[t._v("界面展示")])])],1)],1)},o=[],n=r("01ca"),l={name:"device-log",dicts:["iot_things_type","iot_data_type","iot_yes_no"],props:{product:{type:Object,default:null}},data:function(){return{loading:!1,modelList:[],title:"",queryParams:{productId:0,type:4},form:{}}},watch:{product:function(t,e){this.productInfo=t,this.productInfo&&0!=this.productInfo.productId&&(this.queryParams.productId=this.productInfo.productId,this.getList())}},created:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(n["f"])(this.queryParams).then((function(e){t.modelList=e.rows,t.total=e.total,t.loading=!1}))}}},i=l,s=(r("bc65"),r("2877")),u=Object(s["a"])(i,a,o,!1,null,"cbed3b12",null);e["default"]=u.exports},bc65:function(t,e,r){"use strict";r("fad1")},ddac:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{"padding-left":"20px"}},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:t.queryParams,inline:!0,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"授权码",prop:"authorizeCode"}},[r("el-input",{attrs:{placeholder:"请输入授权码",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.authorizeCode,callback:function(e){t.$set(t.queryParams,"authorizeCode",e)},expression:"queryParams.authorizeCode"}})],1),r("el-form-item",{attrs:{label:"设备编号",prop:"serialNumber"}},[r("el-input",{attrs:{placeholder:"请输入设备编号",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.serialNumber,callback:function(e){t.$set(t.queryParams,"serialNumber",e)},expression:"queryParams.serialNumber"}})],1),r("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[r("el-input",{attrs:{placeholder:"请输入用户名称",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.userName,callback:function(e){t.$set(t.queryParams,"userName",e)},expression:"queryParams.userName"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.handleQuery}},[t._v("搜索")]),r("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1),r("el-row",{staticClass:"mb8",attrs:{gutter:10}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["iot:authorize:add"],expression:"['iot:authorize:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("生成授权码")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["iot:authorize:edit"],expression:"['iot:authorize:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:t.single},on:{click:t.handleUpdate}},[t._v("修改")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["iot:authorize:remove"],expression:"['iot:authorize:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:t.multiple},on:{click:t.handleDelete}},[t._v("删除")])],1),r("el-col",{attrs:{span:1.5}},[r("el-link",{staticStyle:{"padding-top":"5px"},attrs:{type:"danger",underline:!1}},[t._v("注意：绑定设备之后不可以删除。 Tips：双击可以复制授权码。")])],1),r("right-toolbar",{on:{queryTable:t.getList}})],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.authorizeList},on:{"selection-change":t.handleSelectionChange,"cell-dblclick":t.celldblclick}},[r("el-table-column",{attrs:{type:"selection",selectable:t.selectable,width:"55",align:"center"}}),r("el-table-column",{attrs:{label:"ID",width:"55",align:"center",prop:"authorizeId"}}),r("el-table-column",{attrs:{label:"状态",align:"center",prop:"active",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.deviceId?r("el-tag",{attrs:{type:"success"}},[t._v("已使用")]):r("el-tag",{attrs:{type:"info"}},[t._v("未使用")])]}}])}),r("el-table-column",{attrs:{label:"授权码",width:"300",align:"center",prop:"authorizeCode"}}),r("el-table-column",{attrs:{label:"设备ID",width:"75",align:"center",prop:"deviceId"}}),r("el-table-column",{attrs:{label:"设备编号",width:"150",align:"center",prop:"serialNumber"}}),r("el-table-column",{attrs:{label:"用户ID",width:"75",align:"center",prop:"userId"}}),r("el-table-column",{attrs:{label:"用户名称",align:"center",prop:"userName"}}),r("el-table-column",{attrs:{label:"更新时间",align:"center",prop:"updateTime",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(t.parseTime(e.row.updateTime,"{y}-{m}-{d} {h}:{m}:{s}")))])]}}])}),r("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark"}}),r("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["iot:authorize:edit"],expression:"['iot:authorize:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(r){return t.handleUpdate(e.row)}}},[t._v("修改")]),e.row.deviceId?t._e():r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["iot:authorize:remove"],expression:"['iot:authorize:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}}),r("el-dialog",{attrs:{title:t.title,visible:t.open,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"设备ID",prop:"deviceId"}},[r("el-input",{attrs:{placeholder:"请输入设备ID",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:t.form.deviceId,callback:function(e){t.$set(t.form,"deviceId",e)},expression:"form.deviceId"}})],1),r("el-form-item",{attrs:{label:"设备编号",prop:"serialNumber"}},[r("el-input",{attrs:{placeholder:"请输入设备编号"},model:{value:t.form.serialNumber,callback:function(e){t.$set(t.form,"serialNumber",e)},expression:"form.serialNumber"}})],1),r("el-form-item",{attrs:{label:"用户ID",prop:"userId"}},[r("el-input",{attrs:{placeholder:"请输入用户ID",onkeyup:"value=value.replace(/[^\\d]/g,'')",max:""},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1),r("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[r("el-input",{attrs:{placeholder:"请输入用户名称"},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),r("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)},o=[],n=r("5530"),l=(r("d81d"),r("b775"));function i(t){return Object(l["a"])({url:"/iot/authorize/list",method:"get",params:t})}function s(t){return Object(l["a"])({url:"/iot/authorize/"+t,method:"get"})}function u(t){return Object(l["a"])({url:"/iot/authorize/addProductAuthorizeByNum",method:"post",data:t})}function c(t){return Object(l["a"])({url:"/iot/authorize",method:"put",data:t})}function d(t){return Object(l["a"])({url:"/iot/authorize/"+t,method:"delete"})}var p=r("ed08"),m={name:"product-authorize",props:{product:{type:Object,default:null}},watch:{product:function(t,e){this.productInfo=t,this.productInfo&&0!=this.productInfo.productId&&(this.queryParams.productId=this.productInfo.productId,this.getList())}},data:function(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,authorizeList:[],title:"",open:!1,createNum:1,queryParams:{pageNum:1,pageSize:10,authorizeCode:null,productId:null,deviceId:null,serialNumber:null,userId:null,userName:null},form:{},rules:{}}},created:function(){},methods:{getList:function(){var t=this;this.loading=!0,i(this.queryParams).then((function(e){t.authorizeList=e.rows,t.total=e.total,t.loading=!1}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={authorizeId:null,authorizeCode:null,productId:"",deviceId:null,serialNumber:null,userId:"",userName:null,delFlag:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.authorizeId})),this.single=1!==t.lengdelAuthorizeth,this.multiple=!t.length},handleAdd:function(){var t=this;this.$prompt("","输入新增授权码数量",{customClass:"createNum",confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[0-9\-]/,inputErrorMessage:"数量内容不正确",inputType:"number",inputValue:this.createNum}).then((function(e){var r=e.value;if(t.createNum=r,null!=t.queryParams.productId){var a={productId:t.queryParams.productId,createNum:t.createNum};u(a).then((function(e){t.$modal.msgSuccess("新增授权码成功"),t.getList(),t.createNum=1}))}})).catch((function(){t.$message({type:"info",message:"取消新增"})}))},handleUpdate:function(t){var e=this;this.reset();var r=t.authorizeId||this.ids;s(r).then((function(t){e.form=t.data,e.open=!0,e.title="编辑授权码"}))},submitForm:function(){var t=this;this.$refs["form"].validate((function(e){e&&null!=t.form.authorizeId&&c(t.form).then((function(e){t.$modal.msgSuccess("修改成功"),t.open=!1,t.getList()}))}))},handleDelete:function(t){var e=this,r=t.authorizeId||this.ids;this.$modal.confirm('是否确认删除产品授权码编号为"'+r+'"的数据项？').then((function(){return d(r)})).then((function(){e.getList(),e.$modal.msgSuccess("删除成功")})).catch((function(){}))},handleExport:function(){this.download("iot/authorize/export",Object(n["a"])({},this.queryParams),"authorize_".concat((new Date).getTime(),".xlsx"))},handleChange:function(t){console.log(currentValue),Object(p["e"])(currentValue)||this.$modal.msgSuccess("只能输入数字")},selectable:function(t){return null==t.deviceId},celldblclick:function(t,e,r,a){var o=this;this.$copyText(t[e.property]).then((function(t){o.onCopy()}),(function(t){this.onError()}))},onCopy:function(){this.$notify({title:"成功",message:"复制成功！",type:"success",offset:50,duration:2e3})},onError:function(){this.$notify({title:"失败",message:"复制失败！",type:"error",offset:50,duration:2e3})}}},f=m,h=(r("3acd"),r("2877")),b=Object(h["a"])(f,a,o,!1,null,null,null);e["default"]=b.exports},fad1:function(t,e,r){},ffab:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-card",{staticStyle:{margin:"6px","padding-bottom":"100px"}},[r("el-tabs",{staticStyle:{padding:"10px"},attrs:{"tab-position":"left"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[r("el-tab-pane",{attrs:{name:"basic"}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v(" * 基本信息")]),r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[r("el-row",{attrs:{gutter:100}},[r("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"产品名称",prop:"productName"}},[r("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.form.productName,callback:function(e){t.$set(t.form,"productName",e)},expression:"form.productName"}})],1),r("el-form-item",{attrs:{label:"产品分类",prop:"categoryId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择分类"},on:{change:t.selectCategory},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},t._l(t.categoryShortList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),r("el-form-item",{attrs:{label:"联网方式",prop:"networkMethod"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择联网方式"},model:{value:t.form.networkMethod,callback:function(e){t.$set(t.form,"networkMethod",e)},expression:"form.networkMethod"}},t._l(t.dict.type.iot_network_method,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:parseInt(t.value)}})})),1)],1),r("el-form-item",{attrs:{label:"授权码开关",prop:"networkMethod"}},[r("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(e){return t.changeIsAuthorize(t.form.isAuthorize)}},model:{value:t.form.isAuthorize,callback:function(e){t.$set(t.form,"isAuthorize",e)},expression:"form.isAuthorize"}})],1),r("el-form-item",{attrs:{label:"备注信息",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",rows:"3"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),r("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"设备类型",prop:"deviceType"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备类型",disabled:""},model:{value:t.form.deviceType,callback:function(e){t.$set(t.form,"deviceType",e)},expression:"form.deviceType"}},t._l(t.dict.type.iot_device_type,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:parseInt(t.value)}})})),1)],1),r("el-form-item",{attrs:{label:"设备认证",prop:"vertificateMethod"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择认证方式",disabled:""},model:{value:t.form.vertificateMethod,callback:function(e){t.$set(t.form,"vertificateMethod",e)},expression:"form.vertificateMethod"}},t._l(t.dict.type.iot_vertificate_method,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:parseInt(t.value)}})})),1)],1),r("el-form-item",{attrs:{label:"产品编号",prop:"productId"}},[r("el-input",{attrs:{placeholder:"自动生成",disabled:!t.form.mqttAccount,readonly:""},model:{value:t.form.productId,callback:function(e){t.$set(t.form,"productId",e)},expression:"form.productId"}})],1),r("el-form-item",{attrs:{label:"Mqtt账号",prop:"mqttAccount"}},[r("el-input",{attrs:{placeholder:"自动生成",disabled:!t.form.mqttAccount,readonly:"",type:t.accountInputType},model:{value:t.form.mqttAccount,callback:function(e){t.$set(t.form,"mqttAccount",e)},expression:"form.mqttAccount"}},[r("el-button",{staticStyle:{"font-size":"18px"},attrs:{slot:"append",icon:"el-icon-view"},on:{click:function(e){return t.changeInputType("account")}},slot:"append"})],1)],1),r("el-form-item",{attrs:{label:"Mqtt密码",prop:"mqttPassword"}},[r("el-input",{attrs:{placeholder:"自动生成",disabled:!t.form.mqttAccount,readonly:"",type:t.passwordInputType},model:{value:t.form.mqttPassword,callback:function(e){t.$set(t.form,"mqttPassword",e)},expression:"form.mqttPassword"}},[r("el-button",{staticStyle:{"font-size":"18px"},attrs:{slot:"append",icon:"el-icon-view"},on:{click:function(e){return t.changeInputType("password")}},slot:"append"})],1)],1),r("el-form-item",{attrs:{label:"产品秘钥",prop:"mqttSecret"}},[r("el-input",{attrs:{placeholder:"自动生成",disabled:!t.form.mqttAccount,readonly:"",type:t.keyInputType},model:{value:t.form.mqttSecret,callback:function(e){t.$set(t.form,"mqttSecret",e)},expression:"form.mqttSecret"}},[r("el-button",{staticStyle:{"font-size":"18px"},attrs:{slot:"append",icon:"el-icon-view"},on:{click:function(e){return t.changeInputType("key")}},slot:"append"})],1)],1)],1),r("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:8}},[r("el-form-item",{attrs:{label:"产品图片"}},[r("imageUpload",{ref:"image-upload",attrs:{value:t.form.imgUrl,limit:1,fileSize:1},on:{input:function(e){return t.getImagePath(e)}}})],1)],1)],1),r("el-col",{attrs:{span:20}},[r("el-form-item",{staticStyle:{"text-align":"center",margin:"40px 0px"}},[2!=t.form.status?r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm()}}},[t._v("提交")]):t._e()],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"",name:"things",disabled:0==t.form.productId}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v("* 物模型")]),r("product-things-model",{ref:"productThingsModel",attrs:{product:t.form}})],1),r("el-tab-pane",{attrs:{label:"",name:"productAuthorize",disabled:0==t.form.isAuthorize}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v("授权码")]),r("product-authorize",{ref:"productAuthorize",attrs:{product:t.form}})],1),r("el-tab-pane",{attrs:{label:"",name:"alert",disabled:""}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 告警配置")]),r("product-alert",{ref:"productAlert",attrs:{product:t.form}})],1),r("el-tab-pane",{attrs:{label:"",name:"productApp",disabled:""}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v("自定义APP")]),r("product-app",{ref:"productApp",attrs:{product:t.form}})],1),r("el-tab-pane",{attrs:{label:"",disabled:"",name:"product01"}}),r("el-tab-pane",{attrs:{label:"",disabled:"",name:"product02"}}),r("el-tab-pane",{attrs:{label:"",disabled:"",name:"product03"}}),1==t.form.status?r("el-tab-pane",{attrs:{name:"product04"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.changeProductStatus(2)}}},[t._v("发布产品")])],1)]):t._e(),2==t.form.status?r("el-tab-pane",{attrs:{name:"product05"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.changeProductStatus(1)}}},[t._v("取消发布")])],1)]):t._e(),r("el-tab-pane",{attrs:{name:"product06"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.goBack()}}},[t._v("返回列表")])],1)])],1)],1)},o=[],n=(r("b0c0"),r("416d")),l=r("bbfb"),i=r("1850"),s=r("ddac"),u=r("0835"),c=r("1e36"),d=r("9b9c"),p={name:"ProductEdit",dicts:["iot_device_type","iot_network_method","iot_vertificate_method"],components:{productThingsModel:n["default"],productApp:l["default"],productAlert:i["default"],productAuthorize:s["default"],imageUpload:u["a"]},data:function(){return{keyInputType:"password",accountInputType:"text",passwordInputType:"password",activeName:"basic",categoryShortList:[],form:{networkMethod:1,deviceType:1,vertificateMethod:3},rules:{productName:[{required:!0,message:"产品名称不能为空",trigger:"blur"}],categoryId:[{required:!0,message:"产品分类ID不能为空",trigger:"blur"}]},queryParams:{tenantName:null}}},created:function(){var t=this.$route.query&&this.$route.query.productId;this.form.productId=t,0!=this.form.productId&&this.getProduct(),this.init()},methods:{init:function(){var t=this;-1===this.$store.state.user.roles.indexOf("admin")&&(this.queryParams.tenantName=this.$store.state.user.name),Object(c["e"])(this.queryParams).then((function(e){t.categoryShortList=e.data}))},goBack:function(){var t={path:"/iot/product",query:{t:Date.now(),pageNum:this.$route.query.pageNum}};this.$tab.closeOpenPage(t),this.reset()},getProduct:function(){var t=this;Object(d["d"])(this.form.productId).then((function(e){t.form=e.data}))},reset:function(){this.form={productId:0,productName:null,categoryId:null,categoryName:null,status:0,tslJson:null,isAuthorize:0,deviceType:1,networkMethod:1,vertificateMethod:3,mqttAccount:null,mqttPassword:null,mqttSecret:null,remark:null},this.resetForm("form")},submitForm:function(){var t=this;this.$refs["form"].validate((function(e){e&&(null!=t.form.productId&&0!=t.form.productId?Object(d["g"])(t.form).then((function(e){t.$modal.alertSuccess("修改成功")})):Object(d["a"])(t.form).then((function(e){t.$modal.alertSuccess("添加成功,可以开始定义物模型了"),t.form=e.data,t.activeName="things"})))}))},changeProductStatus:function(t){var e=this,r="发生错误了";2==t?r="产品发布后不能再更改产品内容和对应物模型 ！":1==t&&(r="产品下不能有已经创建的设备，才能取消发布哦 ！"),this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var r={};r.productId=e.form.productId,r.status=t,Object(d["b"])(r).then((function(t){e.$modal.alertSuccess(t.msg),e.goBack()})).catch((function(){2==t?e.activeName="things":e.goBack()}))})).catch((function(){e.activeName="basic"}))},selectCategory:function(t){for(var e=0;e<this.categoryShortList.length;e++)if(this.categoryShortList[e].id==t)return void(this.form.categoryName=this.categoryShortList[e].name)},getImagePath:function(t){this.form.imgUrl=t},changeInputType:function(t){"key"==t?this.keyInputType="password"==this.keyInputType?"text":"password":"account"==t?this.accountInputType="password"==this.accountInputType?"text":"password":"password"==t&&(this.passwordInputType="password"==this.passwordInputType?"text":"password")},changeIsAuthorize:function(){var t=this,e="1"==this.form.isAuthorize?"启用":"停用";this.$modal.confirm("确认要"+e+"授权码吗？").then((function(){})).catch((function(){t.form.isAuthorize=0}))}}},m=p,f=r("2877"),h=Object(f["a"])(m,a,o,!1,null,null,null);e["default"]=h.exports}}]);